<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<script type="text/javascript" src="js/jquery-3.2.1.min.js" ></script>
		<script type="text/javascript" src="js/bootstrap.min.js" ></script>
		<title></title>
		
		<style type="text/css">
			
			 #allmap {width: 100%; height:100%;overflow: hidden;font-family:"微软雅黑";}
			 body,html{height:100%,width:100%}
			 #allmap label{
			 	max-width: none;
			 }
			 .carousel-inner img{
			 	width: 268px;
			 	height: 188px;
			 }
			 
		body{
				background-image: url(img/background.jpg);
				padding-right: 0!important;
				
			}
			header{
				height:60px;
				border:1px solid gainsboro;
				text-align: center;
				
			}
			
			#main{
				width:90%;
				margin:20px auto;
				
				background-color: #eee;
			}
			#ptchart{
				width:90%;
				margin:20px auto;
				
				background-color: #eee;
			}
			#main .select{
				height:40px;
				text-align: center;
			}
			#containers #show-menu{
				float: left;
				min-height: 600px;
				width:15%;
				border: 1px solid gainsboro;
				box-sizing: border-box;
				text-align: center;
				
			}
			
			
			ul{
				margin:0;
				padding:0;
				text-align: left;
				
			}
			ul li{
				text-align: center;
				list-style: none;
				border:1px solid #ccc;
				padding :10px 10px;
				cursor: pointer;
			}
			#containers #show-data{
				float: right;
				min-height: 600px;
				width: 23%;
				border:1px solid gainsboro;
				box-sizing: border-box;
				text-align: center;

			}
			#containers article{
				float: left;
				width:62%;
				min-height: 600px;
				box-sizing: border-box;
				
			}
			#clear{
				clear: both;
			}
			footer{
				min-height: 60px;
				color:#444;
				text-align: center;
		
			};

			
		</style>
		
			<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=vrfvZVauPAxORVu0dsBaZ5H7qigMseUC"></script>


	</head>
	<body>
		     
               
                
				
		
		<header>
			<span style="display: inline-block;float: right;"><span id="user"></span>,欢迎登录<a href="login1.html">退出</a></span>
			<h1 style="color: #fff;">农业土地管理GIS子系统</h1>
		</header>
		
	
		<div id = "main">
					<div class="select" id="farm_list">
						<!--
		                	作者：zhzh980@sina.com
		                	时间：2017-05-16
		                	描述：省-城市-农场三级联动
		                -->
		                  <script type="text/javascript" src="js/area.js" ></script>
		                  <script type="text/javascript" src="js/demo.js" ></script>
		      
						        
						            <div>
						                省份：
						                <select name="province">
						                </select>
						                城市：<select name="city">
						                </select>
						                县区：<select name="county">
								       </select>        
						               	
						                农场：<select name="farm">
						                </select>
						                
						                
						                
						         <!--选择按月显示、按周显示、按日即时显示的下拉列表-->
								<link rel="stylesheet" href="css/bootstrap.min.css" />
						<script type="text/javascript" src="js/jquery-3.2.1.min.js" ></script>
						<script type="text/javascript" src="js/bootstrap.min.js" ></script>
				<div class="btn-group">
						<button type="button" class="btn btn-default dropdown-toggle" 
								data-toggle="dropdown">
							获取时间 <span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<li><a href="#" onclick="month_getinfo()">按月获取</a></li>
							<li><a href="#" onclick="week_getinfo()">按周获取</a></li>
							<li><a href="#" onclick="marker_getinfo()">每日即时获取</a></li>
						</ul>
				</div>       
						                
							<!--
			                	作者：zhzh980@sina.com
			                	时间：2017-05-14
			                	描述：添加天气
			                -->
			              
							<iframe style="float: right;" allowtransparency="true" frameborder="0" width="200" height="30" scrolling="no" src="//tianqi.2345.com/plugin/widget/index.htm?s=3&z=2&t=0&v=0&d=2&bd=0&k=&f=&q=1&e=1&a=1&c=57036&w=180&h=36&align=right"></iframe>
						            </div>
						         
						           
						        
						        <script type="text/javascript">
						            //异步调用百度js  
//						            function map_load() {
//						                var load = document.createElement("script");
//						                load.src = "http://api.map.baidu.com/api?v=1.4&callback=map_init";
//						                document.body.appendChild(load);
//						            }
//						            window.onload = map_load;
						
						
						    
						        </script>
						   

                
                
                
                	
					
				<!--农场：
				<select name="farm">
					<option onclick="clearData(this)" value="116.076794,39.597765">中粮智慧农场</option>
					<option onclick="clearData(this)" value="108.629907,34.459544" selected="selected">马庄农场</option>
					<option onclick="clearData(this)" value="109.101565,34.223161">白鹿原生态农场</option>
				</select>-->
					
   					 </div>
	
		<div id="containers">
			<aside id="show-menu">
				<h4><img src="img/平台.png" height="30px" width="30px" align="absbottom"/>管理平台</h4>
				<ul class="nav nav-pills nav-stacked">
		            <li id="1" class="active" onclick="change(this),hide_profile()" value="1"><a href="#">土地信息查询</a></li>
					<li id="2" onclick="change(this),clearData(this),show_profile()" value="0" data-toggle="tooltip" data-placement="right" title="区域颜色：红（严重过量）,黄（稍微过量），蓝（正常），灰（稍微缺乏），黑（严重缺乏）"><a href="#">资源分布</a></li>
					<li id="3" onclick="change(this),clearData(this),marker_getmessage(),hide_profile()" value="0"> <a href="#">病虫害与苗情监测</a></li>
					<li id="4" onclick="change(this),clearData(this),hide_profile()" value="0"><a href="#">数值分析</a></li>
					<li id="5" onclick="change(this),clearData(this),readyrecord(),hide_profile()" value="0"><a href="#">专家管理员数据维护</a></li>
					
				</ul>

			</aside>
			
			<article  id="allmap">
				<div>
					  
				</div>
			
			</article>
			<aside id ="show-data">
				<!--
                	作者：zhzh980@sina.com
                	时间：2017-05-21
                	描述：专家意见及标准值录入
                -->
                <div id="record" style="display: none;">
                	<h4><img src="img/即时监测.png" height="30px" width="30px" align="absbottom">专家记录及标准值录入</h4>
                	<table class="table table-bordered">
                			<thead>
							    <tr>
							      <th>农场区域：</th>
							      <td id="sd_name5"></th>
							    </tr>
							    <tr>
							    	<th>提示：请先点击选择农田采样点，再选择所需功能</th>
							    </tr>
							     
							</thead>
					</table>
				
					
						<div style="padding-left: 40px;padding-top: 100px;">
					    		<div style="float: left;">
								<img src="img/标题.png" height="31.5px" width="31.5px" align="absbottom">
							    </div>	
							    <div style="float: left;">
								<button type="button" class="btn btn-default"  style="background-color: #3176B1;color: white;"
										 data-toggle="modal" data-target="#myModals">
								土壤阈值修改设定
								</button>
								</div>
							</div>
							<!--修改阈值模态框-->
											<div class="modal fade" id="myModals" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
												<div class="modal-dialog" role="document">
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
															<h4 class="modal-title" id="myModalLabel">土壤参数阈值设定</h4>
														</div>
														<div class="modal-body">
															<form class="form-horizontal">
																<div class="form-group">
																	<label for="inputEmail3" class="col-sm-2 control-label">土壤含水量阈值</label>
																	<div class="col-sm-10">
																		<input type="text" class="form-control" id="pro_water" autocomplete="off">
																	</div>
																</div>
																<div class="form-group">
																	<label for="inputPassword3" class="col-sm-2 control-label">土壤酸碱度阈值</label>
																	<div class="col-sm-10">
																		<input type="text" class="form-control" id="pro_pH" autocomplete="off">
																	</div>
																</div>
																<div class="form-group">
																	<label for="inputPassword3" class="col-sm-2 control-label">土壤碱解氮阈值</label>
																	<div class="col-sm-10">
																		<input type="text" class="form-control" id="pro_cN" placeholder="" autocomplete="off">
																	</div>
																</div>
																<div class="form-group">
																	<label for="inputPassword3" class="col-sm-2 control-label">土壤有效磷阈值</label>
																	<div class="col-sm-10">
																		<input type="text" class="form-control" id="pro_cP" placeholder="" autocomplete="off">
																	</div>
																</div>
																<div class="form-group">
																	<label for="inputPassword3" class="col-sm-2 control-label">土壤速效钾阈值</label>
																	<div class="col-sm-10">
																		<input type="text" class="form-control" id="pro_cK" placeholder="" autocomplete="off">
																	</div>
																</div>
																<input type="hidden" id="qqq" />
															</form>
														</div>
														<div class="modal-footer">
															<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
															<button type="button" class="btn btn-primary" onclick="submitbz()">保存</button>
														</div>
													</div>
												</div>
											</div>

								<div style="margin-top: 100px;">
								  
								<div style="padding-left: 40px;padding-top: 50px;">
					    		<div style="float: left;">
								<img src="img/标题.png" height="31.5px" width="31.5px" align="absbottom">
							    </div>	
							    <div style="float: left;">
								<button type="button" class="btn btn-default" title="选择区域"  style="background-color: #3176B1;color: white;"
										data-container="body" data-toggle="popover" data-placement="left" 
										data-content="请点击农场区域" onclick="opens()">
								病虫害知识库数据维护
								</button>
								</div>
							</div>
								</div>
								

                </div>
				<!--
                	作者：zhzh980@sina.com
                	时间：2017-05-19
                	描述：苗情监测与病虫害防治
                -->
                  <div id="plants_pests" style="display: none;">
                	<h4><img src="img/即时监测.png" height="30px" width="30px" align="absbottom">苗情监测与病虫害防治</h4>
                	<table class="table table-bordered">
                			<thead>
							    <tr>
							      <th>农场区域：</th>
							      <td id="sd_name3"></th>
							    </tr>
							    <tr>
							    	<th>农场作物：</th>
							    	<td id="crops3"></td>
							    </tr>
							     <tr>
							    	<th>生长期：</th>
							    	<td id="growth"></td>
							    </tr>
							  </thead>						
							  <tbody>
					</table>
					<!--描述：轮播展示-->
					<div id="myCarousel" class="carousel slide" style="width: 300px;hight:250px">
					<!-- 轮播（Carousel）指标 -->
					<ol class="carousel-indicators">
						<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
						<li data-target="#myCarousel" data-slide-to="1"></li>
						<li data-target="#myCarousel" data-slide-to="2"></li>
					</ol>   
					<!-- 轮播（Carousel）项目 -->
					<div class="carousel-inner">
						<div class="item active">
							<img src="img/slide1.png" id="img1" alt="First slide">
						</div>
						<div class="item">
							<img src="img/slide2.png" id="img2" alt="Second slide" >
						</div>
						<div class="item">
							<img src="img/slide3.png" id="img3" alt="Third slide">
						</div>
					</div>
					<!-- 轮播（Carousel）导航 -->
					<a class="carousel-control left" href="#myCarousel" 
					   data-slide="prev">&lsaquo;</a>
					<a class="carousel-control right" href="#myCarousel" 
					   data-slide="next">&rsaquo;</a>
				    </div> 
				    
					<div class="page-header">
					    <h4>病虫害及苗情记录</h4>
					    	<table class="table table-striped">
						          <tr>
										<th>病虫害名称</th>
										<td id="disease_name11">Bangalore</td>
										
									</tr>
		
							
									<tr>
										<th>记录时间</th>
										<td id="author_time">Bangalore</td>
										
									</tr>
									
									<tr>
										<th>苗情信息</th>
										<td id="show_message">Bangalore</td>
										
									</tr>
									
								</tbody>
							</table>	
					        
					       
					    
					</div>
					
					
					
					<div>
					<button type="button" style="margin-bottom:0px ;" class="btn btn-primary" data-toggle="modal" data-target="#myModal">知识库匹配建议</button>
					
					<!--
                    	作者：zhzh980@sina.com
                    	时间：2017-06-09
                    	描述：知识库匹配建议模态框
                    -->
                    <!-- Button trigger modal -->
								<link rel="stylesheet" href="css/bootstrap.min.css" />
								<!-- Modal -->
								<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
								  <div class="modal-dialog" role="document">
								    <div class="modal-content">
								      <div class="modal-header">
								        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
								        <h4 class="modal-title" id="myModalLabel">病虫害知识库匹配建议</h4>
								      </div>
								      <div class="modal-body">
								               <table class="table table-striped">
													<th>作物</th>
													<td id="crop12">Bangalore</td>
													</tr>
													<tr>
													<th>生长期</th>
													<td id="growth12">Bangalore</td>
													</tr>
						          					<tr>
													<th>病虫害名称</th>
													<td id="disease_name12">Bangalore</td>
													</tr>
													<tr>
													<th>病虫害特征</th>
													<td id="disease_chara12">Bangalore</td>
													</tr>
													<tr>
													<tr>
													<th>治疗措施</th>
													<td id="cure_treat12">Bangalore</td>
													</tr>
													<tr>
													
													</tbody>
												</table>	  
								      </div>
								       
								      <div class="modal-footer">
								        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
								       
								      </div>
								    </div>
								  </div>
								</div>
					
					<button type="button" class="btn btn-primary">在线专家咨询</button>
      				</div>
              </div>
                
                
				<!--
                	作者：zhzh980@sina.com
                	时间：2017-05-15
                	描述：数值分析展示
                -->
                <div id="chartData" style="display: none;">
                	<h4><img src="img/chart.png" height="30px" width="30px" align="absbottom">数值分析</h4>
                	<table class="table table-bordered">
                			<thead>
							    <tr>
							      <th>提示：</th>
							      
							    </tr>
							  	<tr>
							  		<th>请选择要展示的图表，之后地图上选择区域</th>
							 	</tr>						
							  </thead>
							  </tbody>
					</table>
					           <!--
                               	作者：zhzh980@sina.com
                               	时间：2017-05-21
                               	描述：数值分析展示中的弹出框效果
                               -->
								
					    
					    	<div style="padding-left: 40px;padding-top: 50px;">
					    		<div style="float: left;">
								<img src="img/标题.png" height="31.5px" width="31.5px" align="absbottom">
							    </div>	
							    <div style="float: left;">
								<button type="button" class="btn btn-default" title="选择区域"  style="background-color: #3176B1;color: white;"
										data-container="body" data-toggle="popover" data-placement="left" 
										data-content="请点击农场区域" onclick="readychart(1)">
								土壤酸碱度变化图
								</button>
					    	    </div>
					    	</div>
					    	<div style="padding-left: 40px;padding-top: 100px;">
					    		<div style="float: left;">
								<img src="img/标题.png" height="31.5px" width="31.5px" align="absbottom">
							    </div>	
							    <div style="float: left;">
								<button type="button" class="btn btn-default" title="选择区域"  style="background-color: #3176B1;color: white;"
										data-container="body" data-toggle="popover" data-placement="left" 
										data-content="请点击农场区域" onclick="readychart(2)">
								土壤氮含量与土壤温度变化图
								</button>
								</div>
							</div>
							<div style="padding-left: 40px;padding-top: 100px;">
								<div style="float: left;">
								<img src="img/标题.png" height="31.5px" width="31.5px" align="absbottom">
							    </div>
							    <div style="float: left;">
								<button type="button" class="btn btn-default" title="选择区域"  style="background-color: #3176B1;color: white;"
										data-container="body" data-toggle="popover" data-placement="left" 
										data-content="请点击农场区域" onclick="readychart(3)">
								土壤湿度变化图
								</button>
								</div>
							</div>
								
						

		               		
               </div>
				
				
				
				
				<!--
                	作者：zhzh980@sina.com
                	时间：2017-05-14
                	描述：资源分布情况展示
                -->
				<div id="waterData" style="display: none;">
					<h4><img src="img/灌溉.png" height="30px" width="30px" align="absbottom"/>资源情况</h4>
					<!--选择按月、周、日显示的下来菜单-->
					<!--<link rel="stylesheet" href="css/bootstrap.min.css" />
					<script type="text/javascript" src="js/jquery-3.2.1.min.js" ></script>
					<script type="text/javascript" src="js/bootstrap.min.js" ></script>-->
			
				  	<table class="table table-bordered">
							  <caption></caption>
							  <thead>
							    <tr>
							      <th>农场区域：</th>
							      <td id="sd_name2"></th>
							    </tr>
							  </thead>						
							  <tbody>
							    <tr>
							      <th>数据采集时间：</th>
							      <td id="G_time2"></td>
							     
							    </tr>
							 
							</table>
				  <table class="table table-hover">
				
	                    <thead>
		                  <tr onmouseover="water_profile()">
		                  		
								<th>土壤水分</th>
								<th>建议水分</th>
								<th>灌溉建议</th>
						  </tr>
						  		
							</thead>
							<tbody>
								<tr onmouseover="water_profile()">
									
									<td id="wwater"></td>
									<td id="wstwater"></td>
									<td id="wsuwater"></td>
								</tr>
								
							</tbody>
				  </table>
				  
				  <table class="table table-hover">
				  	
	               
	                    <thead>
		                  <tr onmouseover="pH_profile()">
		                  		
								<th>土壤pH</th>
								<th>建议pH</th>
								<th>耕地建议</th>
						  </tr>
						  		
							</thead>
							<tbody>
								<tr onmouseover="pH_profile()">
									
									<td id="wpH"></td>
									<td id="wstpH"></td>
									<td id="wsupH"></td>
								</tr>
								
							</tbody>
				  </table>
				  
				  <table class="table table-hover">
				  	
	               
	                    <thead>
		                  <tr onmouseover="cN_profile()">
		                  		
								<th >土壤氮含量</th>
								<th>建议氮含量</th>
								<th>施肥建议</th>
						  </tr>
						  		
							</thead>
							<tbody>
								<tr onmouseover="cN_profile()">
									
									<td id="wcN"></td>
									<td id="wstcN"></td>
									<td id="wsucN"></td>
								</tr>
								
							</tbody>
				  </table>
				  <table class="table table-hover">
				  	
	              
	                    <thead>
		                  <tr onmouseover="cP_profile()">
		                  		
								<th>土壤磷含量</th>
								<th>建议磷含量</th>
								<th>施肥建议</th>
						  </tr>
						  		
							</thead>
							<tbody>
								<tr onmouseover="cP_profile()">
									
									<td id="wcP"></td>
									<td id="wstcP"></td>
									<td id="wsucP"></td>
								</tr>
								
							</tbody>
				  </table>
				  
				  <table class="table table-hover">
				  	
	               
	                    <thead>
		                  <tr onmouseover="cK_profile()">
		                  		
								<th>土壤钾含量</th>
								<th>建议钾含量</th>
								<th>施肥建议</th>
						  </tr>
						  		
							</thead>
							<tbody>
								<tr onmouseover="cK_profile()">
									
									<td id="wcK"></td>
									<td id="wstcK"></td>
									<td id="wsucK"></td>
								</tr>
								
							</tbody>
				  </table>
				  
				</div>
				<!--
                	作者：zhzh980@sina.com
                	时间：2017-05-14
                	描述：土壤信息资源展示
                -->
				<div id="showData">
				<h4><img src="img/数据.png" height="30px" width="30px" align="absbottom"/>土壤信息</h4>
			<table class="table table-bordered">
							  <caption></caption>
							  <thead>
							    <tr>
							      <th>农场区域：</th>
							      <td id="sd_name"></th>
							    </tr>
							  </thead>						
							  <tbody>
							    <tr>
							      <th>数据采集时间：</th>
							      <td id="G_time"></td>
							     
							    </tr>
							 
							</table>
				       <!--<div align="left" style="height: auto">农场区域：<font size=2px id="sd_name"></font></div>
				       <div align="left" style="height:auto">数据采集时间：<font size=2px id="G_time"></font></div>  -->
				<table class="table table-hover">
	               <caption>基础信息</caption>
	                                      
	                    <thead>
		                  <tr>
								 <th>土壤pH值</th>
								<th>土壤水分</th>
								<th>土壤温度</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td id="ph"></td>
									<td id="water"></td>
									<td id="temp"></td>
								</tr>
								
							</tbody>
				</table>
				<table class="table table-bordered">
							  <caption></caption>
							  <thead>
							    <tr>
							      <th>养分采集时间：</th>
							      <td id="nu_time"></th>
							    </tr>
							  </thead>						
							  <tbody>
							  </table>
				
				<table class="table table-hover">
	               <caption>氮磷钾含量</caption>
	                    <thead>
		                  <tr>
								 <th>土壤碱解氮</th>
								<th>土壤有效磷</th>
								<th>土壤速效钾</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td id="cN"></td>
									<td id="cP"></td>
									<td id="cK"></td>
								</tr>
								
							</tbody>
				</table>
				
				<table class="table table-hover">
	                 <caption>种植作物</caption>
	                    <thead>
		                  <tr>
								 <th>种植作物</th>
								 <td id="crop"></td>
								</tr>
								
							</thead>
							<!--<tbody>
								<tr>
									<td style="float: left" id="crop"></td>
									
								</tr>-->
								
							</tbody>
				</table>
				
				<button class="btn btn-default" id="show_profile" onclick="show_profile()">显示农场轮廓</button>
				<button class="btn btn-default" id="hide_profile" onclick="hide_profile()">隐藏农场轮廓</button>


			</div>
			</aside>
		</div>
		<div id="clear"></div>
		<footer>
			CopyRight©1307010226-张子豪
			
		</footer>
		</div>
		

	</body>
	<script type="text/javascript" src="js/jquery-3.2.1.min.js" ></script>
	<script type="text/javascript">
		// 百度地图API功能
		var map = new BMap.Map("allmap");    // 创建Map实例
	map.centerAndZoom(new BMap.Point(116.404, 39.915), 5);  // 初始化地图,设置中心点坐标和地图级别
	map.addControl(new BMap.MapTypeControl());   //添加地图类型控件
	map.setCurrentCity("西安");          // 设置地图显示的城市 此项是必须设置的
	map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
	//map.setMapType(mapType: BMAP_SATELLITE_MAP);
	
//	$(function(){
//			//切换不同农场
//			$('#farm_list').change(function(){
//			var point = $('#farm_list option:selected').val();
//			var arrays = point.split(",");
//			var pointX = arrays[0];
//			var pointY = arrays[1];
//			map.centerAndZoom(new BMap.Point(pointX, pointY), 17);
//			
//			})
			
	
			
			
			
			
			
									var n1;//获得覆盖物的个数
									var polygons=[];//覆盖物	
									var water_stu=[];
									var cK_stu=[];
	                                var cN_stu=[];
									var cP_stu=[];
	                                var pH_stu=[];
	                                var ns;//农场区域的个数，即marker的个数
	                                var markers=[];//标注点
									var map;
	

	        //根据经纬度显示地区
		 function loadPlace(longitude, latitude, level) {
	                if (parseFloat(longitude) > 0 || parseFloat(latitude) > 0) {
	                    level = level || 13;
	                    //绘制地图
	                   map = new BMap.Map("allmap");    // 创建Map实例
						
	                   map.centerAndZoom(new BMap.Point(longitude, latitude), level);            
	                   map.addControl(new BMap.MapTypeControl());   //添加地图类型控件
					   map.setCurrentCity("西安");          // 设置地图显示的城市 此项是必须设置的
					   map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
	                   /*
	                   
	                                          自动加载标注点及覆盖物，
	                   		农田轮廓的显示及隐藏
	                   */
									// 	alert("您点击了标注");  
											//土地信息Ajax赋值取值 
											//alert(111);
										
											$.ajax({
										     url:'http://localhost:8080/Agis/getmarker.action',// 跳转到 action  
										     type:'GET',  
										  
										     dataType:"json",
										     success:function(data) {  
										       	   ns = data.length;
										       	  var points=[];//坐标值，String
										       	  var names=[];//从后台接收的农场区域
										       	 
										       	  var t = [];//0是lng，1是lat
										       	  var labels=[];//标注旁的文字说明
					
										       	  for(var i=0;i<ns;i++){
										       	  	points.push(data[i].point)
										       	  	names.push(data[i].fzone)
										       	  }
					//					       	  console.log(names)
										       	  for(var i=0;i<ns;i++){
										       	  	t = points[i].split(",");
										       	  	 var lngs = parseFloat(t[0]).toFixed(6);
										       	  	 var lats = parseFloat(t[1]).toFixed(6);//字符串转浮点
										       	  
										       	  	 var point = new BMap.Point(lngs,lats);
										       	  	 markers[i] = new BMap.Marker(point);        // 创建标注    
										       	  
													map.addOverlay(markers[i]);    // 将标注添加到地图中
												//	console.log(lngs[i]+","+lats[i]);
													labels[i] = new BMap.Label(names[i],{offset:new BMap.Size(20,-10)});
													markers[i].setLabel(labels[i]);
										       	  
										       	  }
										       	 
//												if($("#1"))
										    

										     },
										     error:function(data){
										     	alert("Marker获取错误！");
										     }
										   });
										   
									    
									    	//描述：覆盖物渲染效果
									    
									    
									    
										   $.ajax({
										     url:'http://localhost:8080/Agis/getCover.action',// 跳转到 action  
										     type:'GET',  
										  
										     dataType:"json",
										     success:function(data) {  
										       	  n1 = data.length;
										       	  var polypoints=[];//坐标值，String
												  var nwpoint;
												  var nepoint;
												  var swpoint;
												  var sepoint;
												  var farm_id;
										      
										       	  var t0 = [];//0是lng，1是lat
										       	  var t1 = [];
										       	  var t2 = [];
										       	  var t3 = [];
										       	  var lngs1=[];
										       	  var lats1=[];
										       	  
										       	  //alert(data[0].id);
										       	  for(var i=0;i<n1;i++){
										       	  	farm_id=data[i].id;
										       	  	nepoint=data[i].nepoint;
										       	  	nwpoint=data[i].nwpoint;
										       	  	swpoint=data[i].swpoint;
										       	  	sepoint=data[i].sepoint;
										       		 
										       		t0 = nwpoint.split(",");
										       	  	t1 = nepoint.split(",");
										       	  	t2 = swpoint.split(",");
										       	  	t3 = sepoint.split(",");
										       	  	 lngs1[0] = parseFloat(t0[0]).toFixed(6);
										       	  	 lats1[0] = parseFloat(t0[1]).toFixed(6);//字符串转浮点
										       	  	 lngs1[1] = parseFloat(t1[0]).toFixed(6);
										       	  	 lats1[1] = parseFloat(t1[1]).toFixed(6);//字符串转浮点
										       	  	 lngs1[2] = parseFloat(t2[0]).toFixed(6);
										       	  	 lats1[2] = parseFloat(t2[1]).toFixed(6);//字符串转浮点
										       	  	 lngs1[3] = parseFloat(t3[0]).toFixed(6);
										       	  	 lats1[3] = parseFloat(t3[1]).toFixed(6);//字符串转浮点
										       	  	 for(var m=0;m<4;m++){
										       	  	     polypoints[m] = new BMap.Point(lngs1[m],lats1[m]);
					//					       	  	     console.log(polypoints[m]);
										       	  		}	
										       	  		
					    				       	  		  polygons[farm_id] = new BMap.Polygon([polypoints[0],polypoints[1],polypoints[2],polypoints[3]
															], {strokeColor:"blue", strokeWeight:2, strokeOpacity:0.1});  //创建多边形
										       	  
					//								     	console.log(polygons[farm_id]);   
												//	console.log(lngs[i]+","+lats[i]);
														map.addOverlay(polygons[farm_id]);          //增加多边形
														polygons[farm_id].hide();
														
											
										    	}
										       	
										       	 
										       	  
													
										     },
										     error:function(data){
										     	alert("覆盖渲染获取错误！");
										     }
										   });
										   
										   //获取土地资源与标准值的各差距，进行渲染
										   //自动获取
								   
									   	
						           
	                }
	            }
		 
		 
		
		 				//marker绑土壤信息，与下拉菜单月、周、日的选择有关
		 			
		 				//每周获得土壤数据与标准值的差值
		 				function week_getinfo(){
		 						 //标注绑定事件(用闭包，循环绑定)
		                  	 	  for(var i=0;i<ns;i++){
						       	  	(function(i){
						       	  		markers[i].addEventListener("click", function(){
										week(markers[i].getPosition().lng.toFixed(6)+","+markers[i].getPosition().lat.toFixed(6));
										//alert(666);
						       	  	});
						       	  	})(i);
						       	  }
		                  	 	  
		                  	 	  //获取每日标准差值所示的颜色
		                  	 	         $.ajax({
										     url:'http://localhost:8080/Agis/getGap_week.action',// 跳转到 action  
										     type:'GET',  
										  
										     dataType:"json",
										     success:function(data) {  
										       	  n1 = data.length;
										          
										        for(var i=0;i<n1;i++){
										          var farmid=data[i].id;
										          water_stu[farmid]=data[i].water_stu;
												  cK_stu[farmid]=data[i].cK_stu;
						                          cN_stu[farmid]=data[i].cN_stu;
												  cP_stu[farmid]=data[i].cP_stu;
						                          pH_stu[farmid]=data[i].pH_stu;
										       
										       	  console.log(cK_stu[farmid]);
										       	 }   //alert(data[0].id);
										     },
										     error:function(data){
										     	alert("资源分布渲染获取错误！");
										     }
										   });
		 				}
		 				//获取每月的土壤数据和差值颜色
		 				function month_getinfo(){
		 						 //标注绑定事件(用闭包，循环绑定)
		                  	 	  for(var i=0;i<ns;i++){
						       	  	(function(i){
						       	  		markers[i].addEventListener("click", function(){
										month(markers[i].getPosition().lng.toFixed(6)+","+markers[i].getPosition().lat.toFixed(6));
										//alert(666);
						       	  	});
						       	  	})(i);
						       	  }
		                  	 	  
		                  	 	  //获取每日标准差值所示的颜色
		                  	 	         $.ajax({
										     url:'http://localhost:8080/Agis/getGap_month.action',// 跳转到 action  
										     type:'GET',  
										  
										     dataType:"json",
										     success:function(data) {  
										       	  n1 = data.length;
										          
										        for(var i=0;i<n1;i++){
										          var farmid=data[i].id;
										          water_stu[farmid]=data[i].water_stu;
												  cK_stu[farmid]=data[i].cK_stu;
						                          cN_stu[farmid]=data[i].cN_stu;
												  cP_stu[farmid]=data[i].cP_stu;
						                          pH_stu[farmid]=data[i].pH_stu;
										       
										       	  console.log(cK_stu[farmid]);
										       	 }   //alert(data[0].id);
										     },
										     error:function(data){
										     	alert("资源分布渲染获取错误！");
										     }
										   });
		 				}
		 				
		 				//获取每日的土壤数据和差值颜色
		                  function marker_getinfo()
		                  {
		                  			
		                  			 //标注绑定事件(用闭包，循环绑定)
		                  	 	  for(var i=0;i<ns;i++){
						       	  	(function(i){
						       	  		markers[i].addEventListener("click", function(){
										a(markers[i].getPosition().lng.toFixed(6)+","+markers[i].getPosition().lat.toFixed(6));
										//alert(666);
						       	  	});
						       	  	})(i);
						       	  }
		                  	 	  
		                  	 	  //获取每日标准差值所示的颜色
		                  	 	         $.ajax({
										     url:'http://localhost:8080/Agis/getGap.action',// 跳转到 action  
										     type:'GET',  
										  
										     dataType:"json",
										     success:function(data) {  
										       	  n1 = data.length;
										          
										        for(var i=0;i<n1;i++){
										          var farmid=data[i].id;
										          water_stu[farmid]=data[i].water_stu;
												  cK_stu[farmid]=data[i].cK_stu;
						                          cN_stu[farmid]=data[i].cN_stu;
												  cP_stu[farmid]=data[i].cP_stu;
						                          pH_stu[farmid]=data[i].pH_stu;
										       
										       	  console.log(cK_stu[farmid]);
										       	 }   //alert(data[0].id);
										     },
										     error:function(data){
										     	alert("资源分布渲染获取错误！");
										     }
										   });
                          }
		                  //marker绑专家记录信息
		                  function marker_getmessage(){
		                  		 //标注绑定事件(用闭包，循环绑定)
		                  		 
		                  	 	  for(var i=0;i<ns;i++){
						       	  	(function(i){
						       	  		markers[i].addEventListener("click", function(){
										disease_plantsitu(markers[i].getPosition().lng.toFixed(6)+","+markers[i].getPosition().lat.toFixed(6));
										//alert(666);
						       	  	});
						       	  	})(i);
						       	  }
		                  }
	                        //第一栏轮廓的显示与隐藏
				            function show_profile()
				            	{
				            		
				            		for(var i=1;i<=n1;i++){
			            				polygons[i].setFillColor("#fff");  //从资源分布图回来，所有区域褪色
				            		  polygons[i].show();
//				            		  console.log(polygons[i]);
				            		}
				            		
				            		
				            	}
				            
				            	function hide_profile(){
				            		for(var i=1;i<=n1;i++){
				            			
				            			polygons[i].hide();
				            	        	

				            		}
				            		
				            	}
									            	
									//资源分布专用
									//不同资源不同渲染效果
								
									
								function water_profile(){
								
									for(var i=1;i<=n1;i++){
//	                              console.log(water_stu[i]);
									
										polygons[i].setFillColor(water_stu[i]);//水资源分布渲染
										//water_stu[i]是根据地理数据是否达标，后台处理返回要显示的颜色（String）
									}
								}
								
								function pH_profile(){
									
									for(var i=1;i<=n1;i++){
										polygons[i].setFillColor(pH_stu[i]);//pH分布渲染
										//pH_stu[i]是根据地理数据是否达标，后台处理返回要显示的颜色（String）
									}
								}
								
								function cN_profile(){
							
									for(var i=1;i<=n1;i++){
										polygons[i].setFillColor(cN_stu[i]);//氮含量分布渲染
										//cN_stu[i]是根据地理数据是否达标，后台处理返回要显示的颜色（String）
									}
								}
								
								function cP_profile(){
								
									for(var i=1;i<=n1;i++){
										polygons[i].setFillColor(cP_stu[i]);//磷资源分布渲染
										//cP_stu[i]是根据地理数据是否达标，后台处理返回要显示的颜色（String）
									}
								}
								
								function cK_profile(){
									
									for(var i=1;i<=n1;i++){
										polygons[i].setFillColor(cK_stu[i]);//钾资源分布渲染
										//cK_stu[i]是根据地理数据是否达标，后台处理返回要显示的颜色（String）
									}
								}
								
								//数值分析区域，图表区域
								function readychart(flag){  //为每个标注点绑定变量变化图事件
					
					//					window.open("charts.html");
									
										//为每个标注点绑定磷含量与土壤温度变化图事件
									if(flag==1){
										for(var i=0;i<ns;i++){
								       	  	(function(i){
								       	  		
								       	  		markers[i].addEventListener("click",marker_pHchart);
//								       	  		markers[i].removeEventListener("click", marker_kwchart);//执行完后，立即取消绑定
//								       	  		markers[i].removeEventListener("click", marker_nphchart);//执行完后，立即取消绑定
								       	  	})(i);
								       	  }
										}
									if(flag==2){
										
										for(var i=0;i<ns;i++){
								       	  	(function(i){
								       	  		markers[i].addEventListener("click", marker_ntempchart);
//								       	  		markers[i].removeEventListener("click", marker_kwchart);//执行完后，立即取消绑定
//								       	  		markers[i].removeEventListener("click", marker_ptchart);//执行完后，立即取消绑定
								       	  	})(i);
								       	  }
									}
									if(flag==3){
										for(var i=0;i<ns;i++){
								       	  	(function(i){
								       	  		markers[i].addEventListener("click", marker_waterchart);
//								       	  		markers[i].removeEventListener("click", marker_ptchart);//执行完后，立即取消绑定
//								       	  		markers[i].removeEventListener("click", marker_nphchart);//执行完后，立即取消绑定
								       	  	})(i);
								       	  }
									}
                              }
//数值分析，显示图表绑定坐标所触发的函数
   //显示磷与温度折线图
function marker_pHchart(e){
	var p = e.target;
	show_pHchart(p.getPosition().lng.toFixed(6)+","+p.getPosition().lat.toFixed(6));
	loadPlace(p.getPosition().lng.toFixed(6), p.getPosition().lat.toFixed(6), 17);
	//alert(666);
//	p.removeListener("click",marker_ptchart);
//	for(var i1=0;i1<ns;i1++){
// 	  	(function(i1){
// 	  		markers[i1].removeEventListener("click", marker_ptchart);//执行完后，立即取消绑定
// 	  	})(i1);
// 	  }

}
   //显示氮与pH折线图
 function marker_ntempchart(e){
 	
 	var p = e.target;
	show_cNtempchart(p.getPosition().lng.toFixed(6)+","+p.getPosition().lat.toFixed(6));
	loadPlace(p.getPosition().lng.toFixed(6), p.getPosition().lat.toFixed(6), 17);
	//alert(666);
//	for(var i1=0;i1<ns;i1++){
// 	  	(function(i1){
// 	  		markers[i1].removeEventListener("click", marker_nphchart);//执行完后，立即取消绑定
// 	  	})(i1);
// 	  }
}
   //
  function marker_waterchart(e){
  	var p=e.target;
	show_waterchart(p.getPosition().lng.toFixed(6)+","+p.getPosition().lat.toFixed(6));
	loadPlace(p.getPosition().lng.toFixed(6), p.getPosition().lat.toFixed(6), 17);
	//alert(666);
//	for(var i1=0;i1<ns;i1++){
// 	  	(function(i1){
// 	  		markers[i1].removeEventListener("click", marker_kwchart);//执行完后，立即取消绑定
// 	  	})(i1);
// 	  }
}
								
						//专家意见及参考值设定区域，为每个标注绑上获取坐标点的事件
						//---------------------------------
						var pointr;//获取的坐标点
						function readyrecord(){
							for(var i=0;i<ns;i++){
						       	  	(function(i){
						       	  		markers[i].addEventListener("click", function(){
										pointr=markers[i].getPosition().lng.toFixed(6)+","+markers[i].getPosition().lat.toFixed(6);
										//alert(666);
										show_existbnz();
						       	  	});
						       	  	})(i);
						       	  }
						     }
//专家意见及参考值设定区域
	//每个输入框默认显示已有的标准值
	function show_existbnz()
	{
			$.ajax({  
				     url:'http://localhost:8080/Agis/getit.action',// 跳转到 action  
				     type:'GET',  
				     data:{  
				            "point":pointr,
				  
				     },  
				     dataType:"json",
				     success:function(data) {  
				     	
				       $("#sd_name5").html(data.zone)
				       $("#pro_water").val(data.swater)
				        $("#pro_pH").val(data.spH)
//				       $("#pro_water").attr("value",data.swater)
//				       $("#pro_pH").attr("value",data.spH)
				     },
				     error:function(data){
				     	alert("获取标准参数初始值错误！");
										     }
				   });
				   
				   $.ajax({  
				     url:'http://localhost:8080/Agis/getit2.action',// 跳转到 action  
				     type:'GET',  
				     data:{  
				            "point":pointr,
				  
				     },  
				     dataType:"json",
				     success:function(data) {  
				       $("#pro_cK").val(data.scK)
				       $("#pro_cN").val(data.scN)
				       $("#pro_cP").val(data.scP)
//				       $("#pro_cK").attr("value",data.scK)
//				       $("#pro_cN").attr("value",data.scN)
//				       $("#pro_cP").attr("value",data.scP)
				     },
				     error:function(data){
				     	alert("获取标准参数初始值错误！");
										     }
				   });
}
	//提交设定的各参数参考值  bz标准值
function submitbz() {
	swater = parseFloat($("#pro_water").val())
	scN=parseFloat($("#pro_cN").val())
	scP=parseFloat($("#pro_cP").val())
	scK=parseFloat($("#pro_cK").val())
	spH=parseFloat($("#pro_pH").val())
	$.ajax({  
				     url:'http://localhost:8080/Agis/set_gi.action',// 跳转到 action  
				     type:'POST',  
				     data:{  
				            "point":pointr,
				            "swater":swater,
				            "scN":scN,
				            "scP":scP,
				            "scK":scK,
				            "spH":spH
				  
				     },  
				     dataType:"json",
				     success:function(data) {  
				     
				       alert("数据参考值提交成功！");
				     },
				     error:function(data){
				     	alert("数据参考值提交失败！");
										     }
				   });
}
   //提交专家意见message
// function submitmes(){
// 	        m1 = window.location.search;
//			var user_info=m1.replace('?user','').replace('&power','').split('=');
//			pro_name=user_info[1];
//	        pmessage = $("textarea").val();
//	        growth=$("#growth1").val();
//	       
//	$.ajax({  
//   url:'http://localhost:8080/Agis/setmes.action',// 跳转到 action  
//   type:'POST',  
//   data:{  
//          "point":pointr,
//     		"pro_name":pro_name,
//     		"message":pmessage,
//     		"growth":growth
//   },  
//   dataType:"json",
//   success:function(data) {  
//       alert("专家记录与建议提交成功！")
//   },
//   error:function(data){
//   	alert("专家记录与建议提交失败！");
//   }
// });
// }
//								
//数值分析区域，显示图表 
   //打开新的网页，显示磷含量与土壤温度变化
	function show_pHchart(po_s){
		window.open("pHcharts.html?point="+po_s);
	}
	//打开新的网页，显示氮含量与土壤酸碱度变化
	function show_cNtempchart(po_s){
		window.open("ntempcharts.html?point="+po_s);
	}
	//打开新的网页，显示钾含量与土壤湿度变化
	function show_waterchart(po_s){
		window.open("watercharts.html?point="+po_s);
	}
		
		
		
//病虫害信息的的获取，为每个marker绑定新的事件		

	function disease_plantsitu(po){ 
	//土地信息Ajax赋值取值 
	$.ajax({
     url:'http://localhost:8080/Agis/getmessages.action',// 跳转到 action  
     type:'GET',  
     data:{  
            "point":po
     },  
     dataType:"json",
     success:function(data) {  
      
      //苗情监测与病虫害监测
      	
      	$("#crops3").html(data.crop)
        $("#sd_name3").html(data.zone)
      	$("#author_time").html(data.time.substring(0,data.time.length-5)) 
      	$("#disease_name11").html(data.disease_name)
   		$("#show_message").html(data.disease_mes)
   		$("#growth").html(data.growth)
     	$("#img1").attr("src",data.img1)    
     	$("#img2").attr("src",data.img2)
     	$("#img3").attr("src",data.img3)
     	console.log(data)
    	cure_treat(data.id)
     },
     error:function(data){
     	alert("病虫害及苗情信息获取错误或无图像信息！");
     }
   });
   cure_treat();
 }
	
   //病虫害知识库自动匹配治疗措施
   function cure_treat(id){
		   	$.ajax({
		     url:'http://localhost:8080/Agis/getcure.action',// 跳转到 action  
		     type:'GET',  
		     data:{  
		            "id":id
		     },  
		     dataType:"json",
		     success:function(data) {  
		      
		      //建议模态框中的数据
		      
			      	$("#crop12").html(data.crop)
			        $("#growth12").html(data.growth)
			      	$("#disease_name12").html(data.disease_name)
			      	$("#disease_chara12").html(data.disease_chara)
			   		$("#cure_treat12").html(data.cure_treat)
		   	
		      	
		     },
		     error:function(data){
		     		$("#crop12").html("病虫害知识库无匹配信息")
			        $("#growth12").html("病虫害知识库无匹配信息")
			      	$("#disease_name12").html("病虫害知识库无匹配信息")
			      	$("#disease_chara12").html("病虫害知识库无匹配信息")
			   		$("#cure_treat12").html("病虫害知识库无匹配信息")
		     }
		   });
	}
	//设置农场中每块区域的标注
	//
	//
//	var point = new BMap.Point(108.629907,34.459544);
//	var marker = new BMap.Marker(point);        // 创建标注    
//	map.addOverlay(marker);    // 将标注添加到地图中
//	var label1 = new BMap.Label("1号区域",{offset:new BMap.Size(20,-10)});
//	marker.setLabel(label1);
//	//测试---------------------------------------------
//	var point1 = new BMap.Point(108.62343,34.45343);
//	var marker2 = new BMap.Marker(point1);
//	map.addOverlay(marker2);
//	
//	var label2 = new BMap.Label("2号区域",{offset:new BMap.Size(20,-10)});
//	marker2.setLabel(label2);
	//------------------------------------
	//var p="108.629907,34.459544";
//	marker.addEventListener("click", function(){
//		a(marker.getPosition().lng.toFixed(6)+","+marker.getPosition().lat.toFixed(6));
//	});
//	marker2.addEventListener("click",function(){
//		a(marker2.getPosition().lng.toFixed(6)+","+marker2.getPosition().lat.toFixed(6));//否则小数点最后一位是0，会默认略掉
//	})

	//a()是获取标识点地理信息的方法，重要
	//author:zhzh
	//po是向后台传入的标注点的坐标
	function a(po){    
// 	alert("您点击了标注");  
	//土地信息Ajax赋值取值 
	$.ajax({
     url:'http://localhost:8080/Agis/getit.action',// 跳转到 action  
     type:'GET',  
     data:{  
            "point":po
     },  
     dataType:"json",
     success:function(data) {  
       //土地信息 
       console
       $("#sd_name").html(data.zone)
       $("#ph").html(data.pH)
       $("#water").html(data.water+"pF")
       $("#temp").html(data.temp+"℃")
//     $("#cN").html(data.cN)
//     $("#cK").html(data.cK)
//     $("#cP").html(data.cP) 
       $("#G_time").html(data.g_time.substring(0,data.g_time.length-5)) 
       $("#crop").html(data.crop);
       //资源分布信息 
       $("#sd_name2").html(data.zone)
       $("#wwater").html(data.water+"pF")
       $("#wstwater").html(data.swater+"pF")
       $("#wsuwater").html(data.sug_water)
       $("#wpH").html(data.pH)
       $("#wstpH").html(data.spH)
       $("#wsupH").html(data.sug_pH)
       $("#G_time2").html(data.g_time.substring(0,data.g_time.length-5))
      //苗情监测与病虫害监测
      	$("#crops3").html(data.crop)
      
     

       $("#sd_name3").html(data.zone)
      
//     $("#wcK").html(data.cK)
//     $("#wstcK").html(data.scK)
//     $("#wsucK").html(data.sug_cK)
//     $("#wcN").html(data.cN)
//     $("#wstcN").html(data.scN)
//     $("#wsucN").html(data.sug_cN)
//     $("#wcP").html(data.cP)
//     $("#wstcP").html(data.scP)
//     $("#wsucP").html(data.sug_cP)
       //console.log(data)
       //alert(marker.getPosition().lng+"-"+marker.getPosition().lat);
      
     
     
     },
     error:function(data){
     	alert("信息1获取错误！");
     }
   });
   
   $.ajax({
     url:'http://localhost:8080/Agis/getit2.action',// 跳转到 action  
     type:'GET',  
     data:{  
            "point":po
     },  
     dataType:"json",
     success:function(data) {  
       //土地信息 
       console.log(data)
       $("#cN").html(data.cN+"mg/kg")
       $("#cK").html(data.cK+"mg/kg")
       $("#cP").html(data.cP+"mg/kg") 
       $("#nu_time").html(data.nu_time.substring(0,data.nu_time.length-5)) 
   //资源分布信息
      
       $("#wcK").html(data.cK+"mg/kg")
       $("#wstcK").html(data.scK+"mg/kg")
       $("#wsucK").html(data.sug_cK)
       $("#wcN").html(data.cN+"mg/kg")
       $("#wstcN").html(data.scN+"mg/kg")
       $("#wsucN").html(data.sug_cN)
       $("#wcP").html(data.cP+"mg/kg")
       $("#wstcP").html(data.scP+"mg/kg")
       $("#wsucP").html(data.sug_cP)
       //console.log(data)
       //alert(marker.getPosition().lng+"-"+marker.getPosition().lat);
      
     
     
     },
     error:function(data){
     	alert("信息2获取错误！");
     }
   });
   
   
   
	}
	
//a是按日获取，month是按月获取，week是按周获取
function week(po){
	   
// 	alert("您点击了标注");  
	//土地信息Ajax赋值取值 
	$.ajax({
     url:'http://localhost:8080/Agis/getit_week.action',// 跳转到 action  
     type:'GET',  
     data:{  
            "point":po
     },  
     dataType:"json",
     success:function(data) {  
       //土地信息 
       $("#sd_name").html(data.zone)
       $("#ph").html(data.pH)
       $("#water").html(data.water+"pF")
       $("#temp").html(data.temp+"℃")
//     $("#cN").html(data.cN)
//     $("#cK").html(data.cK)
//     $("#cP").html(data.cP) 
       $("#G_time").html(data.g_time.substring(0,10)+"前一周")
       $("#crop").html(data.crop)
       //资源分布信息 
       $("#sd_name2").html(data.zone)
       $("#wwater").html(data.water+"pF")
       $("#wstwater").html(data.swater+"pF")
       $("#wsuwater").html(data.sug_water)
//     $("#wcK").html(data.cK)
//     $("#wstcK").html(data.scK)
//     $("#wsucK").html(data.sug_cK)
//     $("#wcN").html(data.cN)
//     $("#wstcN").html(data.scN)
//     $("#wsucN").html(data.sug_cN)
//     $("#wcP").html(data.cP)
//     $("#wstcP").html(data.scP)
//     $("#wsucP").html(data.sug_cP)
       $("#wpH").html(data.pH)
       $("#wstpH").html(data.spH)
       $("#wsupH").html(data.sug_pH)
       $("#G_time2").html(data.g_time.substring(0,10)+"前一周")
      //苗情监测与病虫害监测
      	$("#crops3").html(data.crop)
      
     

       $("#sd_name3").html(data.zone)
      
       //console.log(data)
       //alert(marker.getPosition().lng+"-"+marker.getPosition().lat);
      
     
     
     },
     error:function(data){
     	alert("信息获取错误！");
     }
   });
   
   $.ajax({
     url:'http://localhost:8080/Agis/getit_week2.action',// 跳转到 action  
     type:'GET',  
     data:{  
            "point":po
     },  
     dataType:"json",
     success:function(data) {  
       //土地信息 

       $("#cN").html(data.cN+"mg/kg")
       $("#cK").html(data.cK+"mg/kg")
       $("#cP").html(data.cP+"mg/kg") 
       $("#nu_time").html(data.nu_time.substring(0,10)+"前一周") 
   //资源分布信息
      
       $("#wcK").html(data.cK+"mg/kg")
       $("#wstcK").html(data.scK+"mg/kg")
       $("#wsucK").html(data.sug_cK)
       $("#wcN").html(data.cN+"mg/kg")
       $("#wstcN").html(data.scN+"mg/kg")
       $("#wsucN").html(data.sug_cN)
       $("#wcP").html(data.cP+"mg/kg")
       $("#wstcP").html(data.scP+"mg/kg")
       $("#wsucP").html(data.sug_cP)
       //console.log(data)
       //alert(marker.getPosition().lng+"-"+marker.getPosition().lat);
      
     
     
     },
     error:function(data){
     	alert("信息2获取错误！");
     }
   });
   
	
}

function month(po){
	   
// 	alert("您点击了标注");  
	//土地信息Ajax赋值取值 
	$.ajax({
     url:'http://localhost:8080/Agis/getit_month.action',// 跳转到 action  
     type:'GET',  
     data:{  
            "point":po
     },  
     dataType:"json",
     success:function(data) {  
       //土地信息 
       $("#sd_name").html(data.zone)
       $("#ph").html(data.pH)
       $("#water").html(data.water+"pF")
       $("#temp").html(data.temp+"℃")
//     $("#cN").html(data.cN)
//     $("#cK").html(data.cK)
//     $("#cP").html(data.cP) 
       $("#G_time").html(data.g_time.substring(0,7))
       $("#crop").html(data.crop)
       //资源分布信息 
       $("#sd_name2").html(data.zone)
       $("#wwater").html(data.water+"pF")
       $("#wstwater").html(data.swater+"pF")
       $("#wsuwater").html(data.sug_water)
//     $("#wcK").html(data.cK)
//     $("#wstcK").html(data.scK)
//     $("#wsucK").html(data.sug_cK)
//     $("#wcN").html(data.cN)
//     $("#wstcN").html(data.scN)
//     $("#wsucN").html(data.sug_cN)
//     $("#wcP").html(data.cP)
//     $("#wstcP").html(data.scP)
//     $("#wsucP").html(data.sug_cP)
       $("#wpH").html(data.pH)
       $("#wstpH").html(data.spH)
       $("#wsupH").html(data.sug_pH)
       $("#G_time2").html(data.g_time.substring(0,7))
      //苗情监测与病虫害监测
      	$("#crops3").html(data.crop)
      
     

       $("#sd_name3").html(data.zone)
      
       //console.log(data)
       //alert(marker.getPosition().lng+"-"+marker.getPosition().lat);
      
     
     
     },
     error:function(data){
     	alert("信息获取错误！");
     }
   });
   
   $.ajax({
     url:'http://localhost:8080/Agis/getit_month2.action',// 跳转到 action  
     type:'GET',  
     data:{  
            "point":po
     },  
     dataType:"json",
     success:function(data) {  
       //土地信息 
//     $("#sd_name").html(data.name)
//     $("#ph").html(data.pH)
//     $("#water").html(data.water)
//     $("#temp").html(data.temp)
       $("#cN").html(data.cN+"mg/kg")
       $("#cK").html(data.cK+"mg/kg")
       $("#cP").html(data.cP+"mg/kg") 
       $("#nu_time").html(data.nu_time.substring(0,7))
//     $("#crop").html(data.crop)
       //资源分布信息 
//     $("#sd_name2").html(data.name)
//     $("#wwater").html(data.water)
//     $("#wstwater").html(data.swater)
//     $("#wsuwater").html(data.sug_water)
       $("#wcK").html(data.cK+"mg/kg")
       $("#wstcK").html(data.scK+"mg/kg")
       $("#wsucK").html(data.sug_cK)
       $("#wcN").html(data.cN+"mg/kg")
       $("#wstcN").html(data.scN+"mg/kg")
       $("#wsucN").html(data.sug_cN)
       $("#wcP").html(data.cP+"mg/kg")
       $("#wstcP").html(data.scP+"mg/kg")
       $("#wsucP").html(data.sug_cP)
//     $("#wpH").html(data.pH)
//     $("#wstpH").html(data.spH)
//     $("#wsupH").html(data.sug_pH)
 
      //苗情监测与病虫害监测
      	$("#crops3").html(data.crop)
      
     

       $("#sd_name3").html(data.zone)
      
       //console.log(data)
       //alert(marker.getPosition().lng+"-"+marker.getPosition().lat);
      
     
     
     },
     error:function(data){
     	alert("信息获取错误！");
     }
   });
	
}

	</script>
	
	<!--
    	作者：zhzh980@sina.com
    	时间：2017-05-14
    	描述：平台管理效果JS
    -->
	<script>
		function change(obj){
			$(obj).addClass("active").siblings().removeClass("active")
			if(obj.id==2){
				$("#showData,#chartData,#plants_pests,#record").fadeOut("slow",function(){
					
				})
	
				$("#waterData").fadeIn("slow",function(){
					
				})
			}
			if(obj.id==1){
				$("#showData").fadeIn("slow",function(){
					
				})
				$("#waterData,#chartData,#plants_pests,#record").fadeOut("slow",function(){
					
				})
			}
	
			if(obj.id==3){
				$("#plants_pests").fadeIn("slow",function(){
					
				})
				$("#waterData,#chartData,#showData,#record").fadeOut("slow",function(){
					
				})
			}
			if(obj.id==4){
				$("#chartData").fadeIn("slow",function(){
					
				})
				$("#waterData,#showData,#plants_pests,#record").fadeOut("slow",function(){
					
				})
				
			}
			if(obj.id==5){
				$("#record").fadeIn("slow",function(){
					
				})
				$("#waterData,#showData,#plants_pests,#chartData").fadeOut("slow",function(){
					
				})
				
			}
			
			
		}
		function clearData(obj){
			$("td").html("")
			$("p").html("")
			$("textarea").val("")
		$("#img1").attr("src","img/slide1.png")    
     	$("#img2").attr("src","img/slide2.png")  
     	$("#img3").attr("src","img/slide3.png")
     	$(".form-control").attr("value","")
		}
	</script>
	<!--
    	作者：zhzh980@sina.com
    	时间：2017-05-14
    	描述：水资源分布，多边形覆盖，渲染效果
    
  	<script type="text/javascript">
    	var polygon = new BMap.Polygon([   //参数都要改！！！！！！！！！！如何删除特定的覆盖物！！！！！
		new BMap.Point(116.387112,39.920977),
		new BMap.Point(116.385243,39.913063),
		new BMap.Point(116.394226,39.917988),
		new BMap.Point(116.401772,39.921364),
		new BMap.Point(116.41248,39.927893)
	], {strokeColor:"blue", strokeWeight:2, strokeOpacity:0.5});  //创建多边形
    </script>
	-->

	<!--
    	作者：zhzh980@sina.com
    	时间：2017-05-15
    	描述：自动加载地图marker点
   -->


    
    <!--
    	作者：zhzh980@sina.com
    	时间：2017-05-15
    	描述：数值分析的水分折线图的JS
    -->

			<!--
            	作者：zhzh980@sina.com
            	时间：2017-05-16
            	描述：图表框点击弹出的特效
            -->
            <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
	        <script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	        <!--选择显示图表时左弹出的效果-->
			<!--<script>
			
				$(function () { 
					$("[data-toggle='popover']").popover();
				});

			</script>-->
		<!--登录欢迎与身份确认-->
		<script>
			
			window.onload=function c(){
				
				m=window.location.search;
				var user_info=m.replace('?user','').replace('&power','').split('=');
				//user_info[0]为空，user_info[1]为用户名,user_info[2]为权限
				alert(user_info[1]+",欢迎登录！");
				$("#user").html(user_info[1]);
				if(user_info[2]==0){
				$("#5").remove();
				}
			}
		</script>
		
		<!--
        	作者：zhzh980@sina.com
        	时间：2017-06-08
        	描述：病虫害知识库打开
        -->
        <script>
        	function opens(){
        		window.open("data_maintain.html");
        	}
        </script>
        
        <!--
        	作者：zhzh980@sina.com
        	时间：2017-06-10
        	描述：bootstrap提示效果
        -->
        <script>
        	
				$(function () { $("[data-toggle='tooltip']").tooltip(); });

        </script>
          
   
	
</html>
